import os
import numpy as np
import matplotlib.pyplot as plt

# Scatter plot to compare Q times
def make_scatter_plot(xarr_1,xarr_2,yarr_1_lst,yarr_2_lst,log=False,xaxis_name="x",yaxis_name="y",tag1="set1",tag2="set2",save_name="test",nevents=None):

    #fig, axs = plt.subplots(nrows=1, ncols=1)

    # Create the figure
    fig, (ax1, ax2, ax3) = plt.subplots(
        nrows=3,
        ncols=1,
        figsize=(7,7),
        gridspec_kw={"height_ratios": (1, 1, 1)},
        sharex=True
    )
    fig.subplots_adjust(hspace=.09)

    # Loop over the sets of events and plot them
    if len(yarr_1_lst) != len(yarr_2_lst): raise Exception("Number of sets of points to plot do not agree between cpu and gpu")
    for i in range(len(yarr_1_lst)):
        print(f"Plotting for set {i}...")
        # Plot the data on main plot
        if i==0:
            ax1.scatter(xarr_1,yarr_1_lst[i],color="orange",edgecolors='orange',facecolors="none",label=tag1,zorder=100)
            ax1.scatter(xarr_2,yarr_2_lst[i],color="blue",edgecolors='blue',facecolors="none",label=tag2,zorder=100)
        else:
            ax1.scatter(xarr_1,yarr_1_lst[i],color="orange",edgecolors='orange',facecolors="none",zorder=100)
            ax1.scatter(xarr_2,yarr_2_lst[i],color="blue",edgecolors='blue',facecolors="none",zorder=100)

        # Plot events/s in kHz
        ax2.scatter(xarr_1,nevents/(1000*yarr_1_lst[i]),color="orange",edgecolors='orange',facecolors="none",zorder=100)
        ax2.scatter(xarr_2,nevents/(1000*yarr_2_lst[i]),color="blue",edgecolors='blue',facecolors="none",zorder=100)

        # Plot the ratio on the ratio plot
        min_len_x = min(len(xarr_1),len(xarr_2))
        r_arr = yarr_1_lst[i][:min_len_x]/yarr_2_lst[i][:min_len_x]
        ax3.scatter(xarr_1[:min_len_x],r_arr,color="orange",edgecolors='orange',facecolors="none",zorder=100)

    # Set log scale
    if log:
        ax1.set_yscale('log')
        ax2.set_yscale('log')
        save_name = save_name+"_log"

    # Set titles and such
    ax1.set_ylabel(yaxis_name)
    ax2.set_ylabel(f"Events/s [kHz]")
    ax1.legend(fontsize="12",framealpha=1)
    ax1.set_title(save_name)
    ax1.grid(zorder=-99)
    ax2.grid(zorder=-99)
    ax3.grid(zorder=-99)
    ax3.axhline(1.0,linestyle="-",color="k",linewidth=1)
    ax3.set_ylabel(f"{tag1}/{tag2}")
    ax3.set_xlabel(xaxis_name)

    #ax1.set_ylim(0.1,10e4)
    #ax2.set_ylim(1,10e5)
    #ax3.set_ylim(-100,1050)

    #ax3.yaxis.set_major_locator(5)
    #plt.yticks(5)
    plt.locator_params(axis="y", nbins=5) 


    plt.savefig(os.path.join(f"plots/{save_name}.png"),format="png")
    plt.savefig(os.path.join(f"plots/{save_name}.pdf"),format="pdf")
    #plt.show()
    return plt



def main():


    # Dict to keep track of the order of the dt time values printed in the timing array
    # The structure of the np array is like:
    # np.array([
    #    [read,load,fill,total times for query 1],
    #    [read,load,fill,total times for query 2], 
    #    ...
    # ]
    time_lables_dict = {
        0 : "read",
        1 : "load",
        2 : "compute",
        3 : "fill",
        4 : "total",
    }

    # Queries (for x axis)
    x_gpu = [1,2,3,4,5,6,7]
    x_cpu = [1,2,3,4,5,6,7,8]

    # Timing numbers
    timing_dict = {

        # Run 100k, about 3m
        "100k" : {
            "nevents" : 100000,
            "y_gpu_arr" : np.array([
                # Example
                [[2.144270420074463, 0.0052378177642822266, 1.9073486328125e-06, 0.09120798110961914, 2.240718126296997], [0.02709674835205078, 0.0020318031311035156, 1.430511474609375e-06, 0.0037124156951904297, 0.032842397689819336], [0.023229360580444336, 0.0006740093231201172, 3.509768486022949, 0.001636505126953125, 3.535308361053467], [0.022994518280029297, 0.0005764961242675781, 0.008098840713500977, 0.0008261203765869141, 0.032495975494384766], [0.013553380966186523, 0.0013649463653564453, 2.219862461090088, 0.0008931159973144531, 2.2356739044189453], [0.020303726196289062, 0.0013508796691894531, 0.33686280250549316, 0.0008966922760009766, 0.35941410064697266], [0.025888442993164062, 0.003199338912963867, 0.1412034034729004, 0.0012288093566894531, 0.17151999473571777]],
            ]),
            "y_cpu_arr" : np.array([
                # Example
                [[0.00448298454284668, 0.0005655288696289062, 0.0, 0.0009770393371582031, 0.006025552749633789], [0.007097482681274414, 0.0003719329833984375, 4.76837158203125e-07, 0.0015561580657958984, 0.009026050567626953], [0.011201858520507812, 0.0005850791931152344, 0.00941157341003418, 0.0005500316619873047, 0.02174854278564453], [0.006860971450805664, 0.0004546642303466797, 0.003831148147583008, 0.00032639503479003906, 0.01147317886352539], [0.009485483169555664, 0.001073598861694336, 0.02265453338623047, 0.0003077983856201172, 0.033521413803100586], [0.02029132843017578, 0.0012133121490478516, 0.3332183361053467, 0.0009164810180664062, 0.3556394577026367], [0.02793097496032715, 0.0024673938751220703, 0.0631263256072998, 0.0006544589996337891, 0.09417915344238281], [0.014684438705444336, 0.0017819404602050781, 0.06895589828491211, 0.00032782554626464844, 0.08575010299682617]]
            ]),
        },

        "1M" : {
            "nevents" : 1e6,
            "y_gpu_arr" : np.array([
                # Nov 2025: Not first run in the session
                [[1.4194347858428955, 0.0012836456298828125, 1.6689300537109375e-06, 0.07095956802368164, 1.4916796684265137], [0.04084634780883789, 0.001856088638305664, 1.9073486328125e-06, 0.0069713592529296875, 0.049675703048706055], [0.03592205047607422, 0.0010631084442138672, 3.600250720977783, 0.004137992858886719, 3.641373872756958], [0.03174734115600586, 0.0008263587951660156, 0.008918046951293945, 0.001161813735961914, 0.042653560638427734], [0.07073736190795898, 0.002425670623779297, 22.656492233276367, 0.0009303092956542969, 22.73058557510376], [0.07549071311950684, 0.0022253990173339844, 25.094982385635376, 0.05057477951049805, 25.223273277282715], [0.14986205101013184, 0.019756317138671875, 0.38420963287353516, 0.0024504661560058594, 0.5562784671783447]],
                [[1.3436038494110107, 0.0013146400451660156, 1.6689300537109375e-06, 0.07088708877563477, 1.4158072471618652], [0.040856122970581055, 0.0016639232635498047, 2.384185791015625e-06, 0.007112264633178711, 0.049634695053100586], [0.03625631332397461, 0.001163482666015625, 3.5463101863861084, 0.004004955291748047, 3.5877349376678467], [0.03118896484375, 0.0007486343383789062, 0.008635997772216797, 0.001096487045288086, 0.04167008399963379], [0.07064652442932129, 0.0021331310272216797, 22.175899982452393, 0.0009603500366210938, 22.249639987945557], [0.0751488208770752, 0.0021038055419921875, 24.59604024887085, 0.05063223838806152, 24.72392511367798], [0.14881610870361328, 0.029242277145385742, 0.3870987892150879, 0.0025131702423095703, 0.5676703453063965]],
                [[1.2017993927001953, 0.0012927055358886719, 2.384185791015625e-06, 0.06975579261779785, 1.2728502750396729], [0.04123568534851074, 0.001672506332397461, 1.6689300537109375e-06, 0.007140398025512695, 0.05005025863647461], [0.03646349906921387, 0.0011873245239257812, 3.6725611686706543, 0.003968238830566406, 3.7141802310943604], [0.03112030029296875, 0.0007891654968261719, 0.0091400146484375, 0.0011234283447265625, 0.042172908782958984], [0.0709848403930664, 0.0023458003997802734, 22.184313535690308, 0.000986337661743164, 22.258630514144897], [0.0759584903717041, 0.0023636817932128906, 24.721407175064087, 0.050604820251464844, 24.85033416748047], [0.1497659683227539, 0.027398347854614258, 0.38051581382751465, 0.0024492740631103516, 0.5601294040679932]],
                # Nov 2025: Not first run in the session new
                #[[0.994821310043335, 0.001230001449584961, 1.6689300537109375e-06, 0.06853556632995605, 1.0645885467529297], [0.040894508361816406, 0.0016896724700927734, 1.6689300537109375e-06, 0.006947994232177734, 0.049533843994140625], [0.035903215408325195, 0.0010380744934082031, 3.7177770137786865, 0.00391077995300293, 3.758629083633423], [0.030930757522583008, 0.0007443428039550781, 0.00847625732421875, 0.0010721683502197266, 0.04122352600097656], [0.07079935073852539, 0.0023365020751953125, 22.266165494918823, 0.0009343624114990234, 22.340235710144043], [0.0755007266998291, 0.002226114273071289, 24.73533058166504, 0.050586700439453125, 24.863644123077393], [0.14876365661621094, 0.030068397521972656, 0.3844177722930908, 0.002432107925415039, 0.5656819343566895]],
                #[[0.7012648582458496, 0.0012607574462890625, 1.9073486328125e-06, 0.06925272941589355, 0.771780252456665], [0.04119706153869629, 0.0017364025115966797, 1.6689300537109375e-06, 0.007188081741333008, 0.05012321472167969], [0.03602457046508789, 0.0010762214660644531, 3.552969217300415, 0.003961324691772461, 3.59403133392334], [0.030972003936767578, 0.0007691383361816406, 0.008521318435668945, 0.0011048316955566406, 0.041367292404174805], [0.0707545280456543, 0.0022993087768554688, 22.384827613830566, 0.0009512901306152344, 22.45883274078369], [0.08025956153869629, 0.007177114486694336, 24.779752492904663, 0.05056262016296387, 24.917751789093018], [0.14746665954589844, 0.029260873794555664, 0.3843235969543457, 0.002475738525390625, 0.5635268688201904]],
                #[[0.891486406326294, 0.0012202262878417969, 2.384185791015625e-06, 0.0685429573059082, 0.961251974105835], [0.04045748710632324, 0.0017626285552978516, 1.6689300537109375e-06, 0.0069866180419921875, 0.04920840263366699], [0.03615570068359375, 0.0010933876037597656, 3.7283952236175537, 0.0038962364196777344, 3.769540548324585], [0.03090357780456543, 0.0007765293121337891, 0.00863337516784668, 0.0011136531829833984, 0.0414271354675293], [0.07087588310241699, 0.0022687911987304688, 22.256234884262085, 0.0009410381317138672, 22.330320596694946], [0.0755929946899414, 0.0022912025451660156, 24.74746608734131, 0.05060744285583496, 24.87595772743225], [0.1610705852508545, 0.029115915298461914, 0.3809792995452881, 0.0024454593658447266, 0.5736112594604492]],

                # Oct 2025: Not first run in the session
                #[[1.8438389301300049, 0.004712343215942383, 1.430511474609375e-06, 0.08623623847961426, 1.9347889423370361], [0.30137109756469727, 0.002364635467529297, 1.6689300537109375e-06, 0.00744938850402832, 0.3111867904663086], [0.052358388900756836, 0.0013396739959716797, 3.4561960697174072, 0.003908634185791016, 3.5138027667999268], [0.03137350082397461, 0.0008075237274169922, 0.010743856430053711, 0.0011014938354492188, 0.04402637481689453], [0.24562788009643555, 0.0025300979614257812, 20.996439933776855, 0.0009207725524902344, 21.245518684387207], [0.07942509651184082, 0.0024271011352539062, 23.552386045455933, 0.05056905746459961, 23.684807300567627], [0.28714776039123535, 0.005764961242675781, 0.4032607078552246, 0.002384185791015625, 0.6985576152801514]],
                #[[1.65358304977417, 0.0034482479095458984, 1.9073486328125e-06, 0.07635354995727539, 1.733386754989624], [0.04059100151062012, 0.0016963481903076172, 1.6689300537109375e-06, 0.006937265396118164, 0.04922628402709961], [0.03651714324951172, 0.0011892318725585938, 3.3982155323028564, 0.0038988590240478516, 3.4398207664489746], [0.03146958351135254, 0.0008134841918945312, 0.008628606796264648, 0.0011048316955566406, 0.04201650619506836], [0.0698709487915039, 0.002220630645751953, 21.262521743774414, 0.0009050369262695312, 21.33551836013794], [0.07564496994018555, 0.0024361610412597656, 23.631060361862183, 0.050608158111572266, 23.7597496509552], [0.1477518081665039, 0.030122041702270508, 0.3798856735229492, 0.002435445785522461, 0.5601949691772461]],
                #[[1.5721306800842285, 0.0018508434295654297, 1.6689300537109375e-06, 0.06838822364807129, 1.642371416091919], [0.04028677940368652, 0.0016465187072753906, 1.6689300537109375e-06, 0.006931304931640625, 0.04886627197265625], [0.036428213119506836, 0.001088857650756836, 3.379329204559326, 0.0038361549377441406, 3.420682430267334], [0.031404972076416016, 0.0008323192596435547, 0.008663654327392578, 0.0011115074157714844, 0.04201245307922363], [0.07005476951599121, 0.0022666454315185547, 20.928296327590942, 0.000888824462890625, 21.001506567001343], [0.07555794715881348, 0.0026099681854248047, 23.434308290481567, 0.05063962936401367, 23.56311583518982], [0.14769792556762695, 0.03016376495361328, 0.3757970333099365, 0.0023789405822753906, 0.5560376644134521]],
                #[[1.6719496250152588, 0.004891157150268555, 1.430511474609375e-06, 14.391260862350464, 16.068103075027466], [0.040779829025268555, 0.002293109893798828, 1.9073486328125e-06, 0.007574796676635742, 0.05064964294433594], [0.037157535552978516, 0.0010986328125, 7.0826146602630615, 0.0040264129638671875, 7.124897241592407], [0.031304359436035156, 0.0008151531219482422, 0.010962724685668945, 0.0010912418365478516, 0.044173479080200195], [0.06985330581665039, 0.0023174285888671875, 21.210305213928223, 0.0009377002716064453, 21.283413648605347], [0.0763087272644043, 0.002468585968017578, 23.681931018829346, 0.05060434341430664, 23.811312675476074], [0.14772462844848633, 0.013870954513549805, 1.3408823013305664, 0.0024437904357910156, 1.5049216747283936]],
            ]),
            "y_cpu_arr" : np.array([
                # Nov 2025: Not first run in the session
                [[0.007979393005371094, 0.011751890182495117, 2.384185791015625e-07, 0.4332144260406494, 0.4529459476470947], [0.04378509521484375, 0.47420287132263184, 2.384185791015625e-07, 0.016131877899169922, 0.5341200828552246], [0.08265805244445801, 0.9440765380859375, 0.11240768432617188, 0.0034279823303222656, 1.1425702571868896], [0.047254085540771484, 0.4439051151275635, 0.03561711311340332, 0.0009379386901855469, 0.5277142524719238], [0.06969904899597168, 0.8743102550506592, 0.14915204048156738, 0.0006699562072753906, 1.0938313007354736], [0.22138023376464844, 2.349369764328003, 8.198939323425293, 0.011977434158325195, 10.78166675567627], [0.23945164680480957, 2.8500301837921143, 0.8376741409301758, 0.004274606704711914, 3.9314305782318115], [0.10598444938659668, 0.9188613891601562, 0.024857521057128906, 0.0002949237823486328, 1.0499982833862305]],
                [[0.008711099624633789, 0.012888193130493164, 4.76837158203125e-07, 0.20273852348327637, 0.22433829307556152], [0.046927452087402344, 0.5004467964172363, 2.384185791015625e-07, 0.01640939712524414, 0.5637838840484619], [0.08501720428466797, 0.9312248229980469, 0.11392998695373535, 0.0034804344177246094, 1.1336524486541748], [0.044450998306274414, 0.475963830947876, 0.03543448448181152, 0.0008268356323242188, 0.5566761493682861], [0.0657796859741211, 0.8456020355224609, 0.14643573760986328, 0.0006551742553710938, 1.0584726333618164], [0.20572257041931152, 2.3615128993988037, 8.241766929626465, 0.01322793960571289, 10.822230339050293], [0.23647141456604004, 2.9071707725524902, 0.8690383434295654, 0.004407167434692383, 4.017087697982788], [0.11139225959777832, 0.9282901287078857, 0.025942087173461914, 0.00025916099548339844, 1.0658836364746094]],
                [[0.008363723754882812, 0.012186288833618164, 4.76837158203125e-07, 0.03566741943359375, 0.05621790885925293], [0.04460763931274414, 0.47858333587646484, 2.384185791015625e-07, 0.01690673828125, 0.5400979518890381], [0.0854642391204834, 0.9773924350738525, 0.11980199813842773, 0.0036308765411376953, 1.1862895488739014], [0.048650503158569336, 0.46454620361328125, 0.03668093681335449, 0.0009834766387939453, 0.550861120223999], [0.07152056694030762, 0.873563289642334, 0.14853739738464355, 0.0006914138793945312, 1.0943126678466797], [0.20119881629943848, 2.29823899269104, 8.047771453857422, 0.012212991714477539, 10.559422254562378], [0.23079228401184082, 2.855673313140869, 0.8253307342529297, 0.004236936569213867, 3.9160332679748535], [0.10574698448181152, 0.9671657085418701, 0.026561498641967773, 0.0003046989440917969, 1.0997788906097412]],
                # Nov 2025: Not first run in the session new
                #[[0.008196115493774414, 0.00010251998901367188, 2.384185791015625e-07, 0.011604070663452148, 0.019902944564819336], [0.04790782928466797, 0.0001697540283203125, 0.0, 0.022108793258666992, 0.07018637657165527], [0.0851144790649414, 0.00014829635620117188, 0.12665700912475586, 0.0032112598419189453, 0.21513104438781738], [0.04903411865234375, 0.0001399517059326172, 0.03571605682373047, 0.0008862018585205078, 0.08577632904052734], [0.0821993350982666, 0.00023484230041503906, 0.1396338939666748, 0.0006468296051025391, 0.22271490097045898], [0.19675469398498535, 0.00020837783813476562, 8.020274639129639, 0.006326913833618164, 8.223564624786377], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],
                #[[0.00827646255493164, 0.00010013580322265625, 4.76837158203125e-07, 0.011568784713745117, 0.019945859909057617], [0.0481112003326416, 0.00015926361083984375, 0.0, 0.022307157516479492, 0.07057762145996094], [0.08570551872253418, 0.00014400482177734375, 0.12725090980529785, 0.0032434463500976562, 0.21634387969970703], [0.04942607879638672, 0.000141143798828125, 0.03403878211975098, 0.0008695125579833984, 0.08447551727294922], [0.08315181732177734, 0.00022292137145996094, 0.14448118209838867, 0.0006287097930908203, 0.2284846305847168], [0.19574451446533203, 0.00020194053649902344, 7.903306007385254, 0.006218433380126953, 8.105470895767212], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],
                #[[0.00835275650024414, 9.775161743164062e-05, 2.384185791015625e-07, 0.10630583763122559, 0.11475658416748047], [0.0460352897644043, 0.0001571178436279297, 0.0, 0.021760225296020508, 0.06795263290405273], [0.08213162422180176, 0.00014472007751464844, 0.1273651123046875, 0.003464221954345703, 0.2131056785583496], [0.04741406440734863, 0.00014591217041015625, 0.03562355041503906, 0.0009360313415527344, 0.08411955833435059], [0.08309578895568848, 0.00023627281188964844, 0.1434948444366455, 0.00064849853515625, 0.22747540473937988], [0.1991558074951172, 0.0001995563507080078, 7.992955684661865, 0.0063593387603759766, 8.198670387268066], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],

                # Oct 2025: Not first run in the session
                #[[0.008423328399658203, 0.01165461540222168, 4.76837158203125e-07, 0.004821300506591797, 0.024899721145629883], [0.04226398468017578, 0.4848017692565918, 2.384185791015625e-07, 0.015774965286254883, 0.5428409576416016], [0.0798482894897461, 0.9398617744445801, 0.10939717292785645, 0.0032720565795898438, 1.1323792934417725], [0.04354691505432129, 0.4469723701477051, 0.034151315689086914, 0.0008814334869384766, 0.5255520343780518], [0.06508803367614746, 0.8205957412719727, 0.14017200469970703, 0.0006527900695800781, 1.0265085697174072], [0.19626069068908691, 2.2905116081237793, 8.424591064453125, 0.0063707828521728516, 10.917734146118164], [0.233245849609375, 2.8491427898406982, 0.8442635536193848, 0.004139423370361328, 3.9307916164398193], [0.14404058456420898, 0.910529375076294, 0.5769891738891602, 0.0007419586181640625, 1.6323010921478271]],
                #[[0.008526086807250977, 0.011503458023071289, 2.384185791015625e-07, 0.004793405532836914, 0.02482318878173828], [0.04246926307678223, 0.4736311435699463, 4.76837158203125e-07, 0.01682758331298828, 0.532928466796875], [0.08041214942932129, 0.9211568832397461, 0.1107945442199707, 0.0032308101654052734, 1.1155943870544434], [0.04365277290344238, 0.44280266761779785, 0.0329439640045166, 0.0008420944213867188, 0.5202414989471436], [0.0654134750366211, 0.8018980026245117, 0.13703441619873047, 0.0006554126739501953, 1.0050013065338135], [0.19711995124816895, 2.2704994678497314, 7.8084635734558105, 0.006009817123413086, 10.282092809677124], [0.23181581497192383, 2.7842724323272705, 0.8262193202972412, 0.004186868667602539, 3.846494436264038], [0.10234212875366211, 0.9417541027069092, 0.5820846557617188, 0.0006968975067138672, 1.626877784729004]],
                #[[0.008370399475097656, 0.010797739028930664, 4.76837158203125e-07, 0.004731416702270508, 0.02390003204345703], [0.04276108741760254, 0.482830286026001, 4.76837158203125e-07, 0.015757083892822266, 0.541348934173584], [0.07880949974060059, 0.9424989223480225, 0.11024117469787598, 0.003200054168701172, 1.1347496509552002], [0.04351377487182617, 0.4546802043914795, 0.03407025337219238, 0.0008711814880371094, 0.5331354141235352], [0.06483030319213867, 0.8071448802947998, 0.13172698020935059, 0.0006358623504638672, 1.004338026046753], [0.19876885414123535, 2.321704864501953, 8.374224185943604, 0.006059408187866211, 10.900757312774658], [0.2275686264038086, 2.8018195629119873, 0.8318209648132324, 0.004132747650146484, 3.865341901779175], [0.10260939598083496, 0.9584133625030518, 0.5809645652770996, 0.0006804466247558594, 1.6426677703857422]],
                #[[0.00815725326538086, 0.011823415756225586, 2.384185791015625e-07, 0.004824399948120117, 0.024805307388305664], [0.0447382926940918, 0.46716761589050293, 7.152557373046875e-07, 0.01609516143798828, 0.5280017852783203], [0.08342766761779785, 0.9147956371307373, 0.14674997329711914, 0.0033690929412841797, 1.1483423709869385], [0.04599142074584961, 0.44071340560913086, 0.03262042999267578, 0.0008518695831298828, 0.5201771259307861], [0.06499624252319336, 0.8060362339019775, 0.16067981719970703, 0.0006346702575683594, 1.0323469638824463], [0.20234203338623047, 2.2491772174835205, 7.926513910293579, 0.006731510162353516, 10.384764671325684], [0.23135662078857422, 2.758131742477417, 0.8085637092590332, 0.004128932952880859, 3.8021810054779053], [0.10287165641784668, 0.9009122848510742, 0.5519974231719971, 0.0006940364837646484, 1.5564754009246826]],
            ]),
        },

        # Takes about 40m to run
        "10M" : {
            "nevents" : 1e6,
            "y_gpu_arr" : np.array([
                # Dec 2025: Not first run in the session, B200
                [[2.583134889602661, 0.0020995140075683594, 3.337860107421875e-06, 0.10617232322692871, 2.6914100646972656], [0.8009774684906006, 0.002617359161376953, 3.337860107421875e-06, 0.014635562896728516, 0.8182337284088135], [0.5120646953582764, 0.0016787052154541016, 5.119068622589111, 0.00767207145690918, 5.640484094619751], [0.06535029411315918, 0.0011532306671142578, 0.012721776962280273, 0.0024347305297851562, 0.08166003227233887], [0.7036840915679932, 0.0032770633697509766, 308.5292012691498, 0.002506256103515625, 309.23866868019104], [0.572075366973877, 0.003353595733642578, 316.8836078643799, 0.012305974960327148, 317.47134280204773], [0.3380603790283203, 0.008535623550415039, 0.3716151714324951, 0.008211851119995117, 0.7264230251312256]],
                [[2.8612465858459473, 0.0021028518676757812, 3.0994415283203125e-06, 0.11818909645080566, 2.981541633605957], [0.06698393821716309, 0.0031044483184814453, 2.86102294921875e-06, 0.015297651290893555, 0.0853888988494873], [0.07854294776916504, 0.0014386177062988281, 5.157371520996094, 0.007364988327026367, 5.244718074798584], [0.08136558532714844, 0.0010502338409423828, 0.014008045196533203, 0.0024721622467041016, 0.09889602661132812], [0.11935687065124512, 0.0032651424407958984, 306.58632373809814, 0.002482891082763672, 306.71142864227295], [0.24587202072143555, 0.0033254623413085938, 310.40834069252014, 0.013386249542236328, 310.6709244251251], [0.3832728862762451, 0.008372068405151367, 0.3662409782409668, 0.00799107551574707, 0.7658770084381104]],
                [[2.1985154151916504, 0.0022788047790527344, 3.0994415283203125e-06, 0.12029433250427246, 2.321091651916504], [0.06708431243896484, 0.0024950504302978516, 3.0994415283203125e-06, 0.014895439147949219, 0.08447790145874023], [0.07817578315734863, 0.0014989376068115234, 5.132684707641602, 0.007754325866699219, 5.220113754272461], [0.06663990020751953, 0.0011723041534423828, 0.013961553573608398, 0.0024728775024414062, 0.08424663543701172], [0.11919093132019043, 0.0032453536987304688, 304.5794081687927, 0.0025594234466552734, 304.7044038772583], [1.861753225326538, 0.0033364295959472656, 311.77276587486267, 0.012265682220458984, 313.6501212120056], [0.5227899551391602, 0.008448600769042969, 0.3674917221069336, 0.007987022399902344, 0.9067173004150391]],
                [[6.247254371643066, 0.0034275054931640625, 3.337860107421875e-06, 8.622198104858398, 14.872883319854736], [0.930614709854126, 0.002908945083618164, 3.5762786865234375e-06, 0.022197246551513672, 0.9557244777679443], [0.6121816635131836, 0.0016341209411621094, 12.838335037231445, 0.007668495178222656, 13.459819316864014], [0.07169461250305176, 0.0011637210845947266, 0.01342320442199707, 0.002469778060913086, 0.08875131607055664], [0.5703234672546387, 0.0033278465270996094, 303.73213958740234, 0.0025234222412109375, 304.3083143234253], [0.6377625465393066, 0.0034117698669433594, 311.11870980262756, 0.012308597564697266, 311.7721927165985], [0.34566736221313477, 0.008418083190917969, 0.3759622573852539, 0.007997989654541016, 0.7380456924438477]],
                # Jul 2025: Not first run in the session (had run on smaller sample first), sync time for GPU, pyarrow for cpu
                #[[1.5815753936767578, 0.00156402587890625, 0.07590317726135254, 1.6590425968170166], [0.07701683044433594, 0.0016074180603027344, 0.038376569747924805, 0.11700081825256348], [0.09454607963562012, 0.0021135807037353516, 3.0548038482666016, 3.151463508605957], [0.07436060905456543, 0.001234292984008789, 0.03155684471130371, 0.10715174674987793], [0.13285064697265625, 0.005905628204345703, 1.1622741222381592, 1.3010303974151611]],
                #[[1.6861388683319092, 0.0018656253814697266, 0.07868528366088867, 1.7666897773742676], [0.07832741737365723, 0.0018076896667480469, 0.03959178924560547, 0.11972689628601074], [0.09486174583435059, 0.0021278858184814453, 3.0948309898376465, 3.1918206214904785], [0.07574081420898438, 0.001272439956665039, 0.0317685604095459, 0.10878181457519531], [0.12839722633361816, 0.005967378616333008, 1.1795237064361572, 1.3138883113861084]],
                #[[2.076409101486206, 0.00516200065612793, 4.802795648574829, 6.884366750717163], [0.5489840507507324, 0.002950906753540039, 0.0398101806640625, 0.591745138168335], [0.09500670433044434, 0.0021047592163085938, 5.1707375049591064, 5.267848968505859], [0.07592463493347168, 0.0012633800506591797, 0.0326848030090332, 0.10987281799316406], [0.6212971210479736, 0.005972623825073242, 0.7522389888763428, 1.3795087337493896]],
            ]),
            "y_cpu_arr" : np.array([
                # Dec 2025: Not first run in the session, B200
                [[0.07274723052978516, 0.1646132469177246, 2.384185791015625e-07, 0.32733964920043945, 0.5647003650665283], [0.4546353816986084, 7.156789779663086, 2.384185791015625e-07, 0.3818795680999756, 7.993304967880249], [0.7910258769989014, 14.3222074508667, 1.9561042785644531, 0.08374881744384766, 17.1530864238739], [0.3916165828704834, 7.1941282749176025, 0.7550404071807861, 0.0423123836517334, 8.383097648620605], [0.7347025871276855, 15.95890498161316, 2.6544172763824463, 0.03841543197631836, 19.38644027709961], [2.03226375579834, 35.21055841445923, 148.57108688354492, 0.3664274215698242, 186.18033647537231], [3.1826982498168945, 47.19903826713562, 17.875795125961304, 0.06843256950378418, 68.3259642124176], [1.6120648384094238, 18.695516347885132, 10.523155450820923, 0.04011273384094238, 30.87084937095642]],
                [[0.07596302032470703, 0.15252208709716797, 2.384185791015625e-07, 0.514880895614624, 0.7433662414550781], [0.4813995361328125, 7.179549694061279, 0.0, 0.38495779037475586, 8.045907020568848], [0.8411295413970947, 14.31740665435791, 1.9235479831695557, 0.07810115814208984, 17.16018533706665], [0.41860151290893555, 7.2023069858551025, 0.6706135272979736, 0.03412961959838867, 8.3256516456604], [0.7669422626495361, 16.00529909133911, 2.704575300216675, 0.036997079849243164, 19.513813734054565], [2.1914148330688477, 35.335773944854736, 147.713632106781, 0.4701993465423584, 185.71102023124695], [3.1131789684295654, 47.409752368927, 17.805886030197144, 0.08825182914733887, 68.41706919670105], [1.4555444717407227, 18.736700773239136, 10.505656242370605, 0.03701186180114746, 30.73491334915161]],
                [[0.16204118728637695, 0.15328454971313477, 2.384185791015625e-07, 0.4652082920074463, 0.7805342674255371], [0.47129106521606445, 7.168853759765625, 2.384185791015625e-07, 0.3886878490447998, 8.028832912445068], [0.8026123046875, 14.333273887634277, 1.9642767906188965, 0.08164572715759277, 17.181808710098267], [0.39839911460876465, 7.183846950531006, 0.6623263359069824, 0.03102731704711914, 8.275599718093872], [0.7804675102233887, 16.03847050666809, 2.6563947200775146, 0.042223215103149414, 19.517555952072144], [2.1793782711029053, 35.39009237289429, 147.77209043502808, 0.3925971984863281, 185.7341582775116], [3.0966639518737793, 47.17788314819336, 17.73545551300049, 0.07094526290893555, 68.08094787597656], [1.4998257160186768, 18.665286540985107, 10.65920376777649, 0.033672332763671875, 30.857988357543945]],
                [[0.07537698745727539, 0.15643000602722168, 0.0, 0.7964076995849609, 1.028214693069458], [0.4753868579864502, 7.164757251739502, 2.384185791015625e-07, 0.3658747673034668, 8.006019115447998], [0.8278288841247559, 14.310896873474121, 1.9183080196380615, 0.08270072937011719, 17.139734506607056], [0.4189326763153076, 7.220498323440552, 0.6662566661834717, 0.03770637512207031, 8.343394041061401], [0.7524495124816895, 16.1079044342041, 2.8008522987365723, 0.03126192092895508, 19.69246816635132], [2.0677058696746826, 35.470999002456665, 147.76854300498962, 0.3591604232788086, 185.66640830039978], [3.1638405323028564, 47.29929232597351, 17.760777235031128, 0.06632590293884277, 68.29023599624634], [1.6733829975128174, 18.670965433120728, 10.412694454193115, 0.04093122482299805, 30.797974109649658]],
                # Jul 2025: Not first run in the session (had run on smaller sample first), sync time for GPU, pyarrow for cpu
                #[[0.04200387001037598, 0.09935307502746582, 0.056989431381225586, 0.19834637641906738], [0.3683950901031494, 4.350168228149414, 0.19568085670471191, 4.914244174957275], [0.6780776977539062, 8.776479244232178, 1.2706658840179443, 10.725222826004028], [0.3434610366821289, 4.401387453079224, 0.39362525939941406, 5.138473749160767], [0.6263217926025391, 8.871382713317871, 1.6156229972839355, 11.113327503204346], [1.7731642723083496, 21.914700508117676, 72.51578760147095, 96.20365238189697], [2.593351364135742, 27.898444890975952, 9.290273666381836, 39.78206992149353], [1.289369821548462, 10.471790552139282, 6.647113084793091, 18.408273458480835]],
                #[[0.041960954666137695, 0.09601473808288574, 0.056436777114868164, 0.1944124698638916], [0.3701472282409668, 4.3522789478302, 0.19462251663208008, 4.917048692703247], [0.6835751533508301, 8.78408932685852, 1.258218765258789, 10.72588324546814], [0.3445723056793213, 4.429948806762695, 0.39241695404052734, 5.166938066482544], [0.6315445899963379, 8.815284013748169, 1.615509033203125, 11.062337636947632], [1.740649700164795, 22.061144590377808, 72.15735483169556, 95.95914912223816], [2.342261552810669, 27.87834119796753, 9.386913537979126, 39.607516288757324], [1.0867652893066406, 10.180213451385498, 6.834189176559448, 18.101167917251587]],
                #[[0.07789087295532227, 0.09351325035095215, 0.057554006576538086, 0.2289581298828125], [0.3616511821746826, 4.343311071395874, 0.18419861793518066, 4.889160871505737], [0.6643061637878418, 8.726859331130981, 1.2653675079345703, 10.656533002853394], [0.3326690196990967, 4.400164842605591, 0.3871748447418213, 5.120008707046509], [0.6314654350280762, 8.807303428649902, 1.657123327255249, 11.095892190933228], [1.7669188976287842, 21.67437195777893, 72.2206289768219, 95.66191983222961], [2.3154752254486084, 27.49279236793518, 9.342978954315186, 39.151246547698975], [1.078124761581421, 10.38680124282837, 6.869341135025024, 18.334267139434814]],
            ]),
        },

        # Never run to full completion on CPU, many hours
        "53M" : {
            "nevents" : 53446198,
            "y_gpu_arr" : np.array([
            ]),
            "y_cpu_arr" : np.array([
            ]),
        },
    }

    # Make the plots
    cat_to_plot = "10M"
    #cat_to_plot = "1M"
    for dt_category_idx,dt_category_label in time_lables_dict.items():
        nevts = timing_dict[cat_to_plot]["nevents"]
        y_gpu = timing_dict[cat_to_plot]["y_gpu_arr"][:,:,dt_category_idx]
        y_cpu = timing_dict[cat_to_plot]["y_cpu_arr"][:,:,dt_category_idx]
        make_scatter_plot(x_cpu,x_gpu,y_cpu,y_gpu,xaxis_name=f"Benchmark Queries ({dt_category_label})",yaxis_name="Runtime [s]", tag1="CPU", tag2="GPU",save_name=f"adl_benchmarks_nEvents{cat_to_plot}_{dt_category_label}",log=False,nevents=nevts)
        make_scatter_plot(x_cpu,x_gpu,y_cpu,y_gpu,xaxis_name=f"Benchmark Queries ({dt_category_label})",yaxis_name="Runtime [s]", tag1="CPU", tag2="GPU",save_name=f"adl_benchmarks_nEvents{cat_to_plot}_{dt_category_label}",log=True,nevents=nevts)


main()




